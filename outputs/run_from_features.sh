#!/usr/bin/env bash
set -euo pipefail

mpiexec -hostfile ~/hfile -genv LD_PRELOAD /mnt/hasanfs/darshan-3.4.7/darshan-runtime/install/lib/libdarshan.so -n 10 /mnt/hasanfs/bin/ior -a MPIIO -k -r -c -b 309264384 -t 64k -o /mnt/hasanfs/synth_from_features/ior_shared_sequential_r_small.dat  # IOR shared sequential r small
mpiexec -hostfile ~/hfile -genv LD_PRELOAD /mnt/hasanfs/darshan-3.4.7/darshan-runtime/install/lib/libdarshan.so -n 10 /mnt/hasanfs/bin/ior -a MPIIO -k -r -c -b 402653184 -t 128m -o /mnt/hasanfs/synth_from_features/ior_shared_sequential_r_large.dat  # IOR shared sequential r large
mpiexec -hostfile ~/hfile -genv LD_PRELOAD /mnt/hasanfs/darshan-3.4.7/darshan-runtime/install/lib/libdarshan.so -n 10 /mnt/hasanfs/bin/ior -a MPIIO -k -r -z -b 309264384 -t 64k -o /mnt/hasanfs/synth_from_features/ior_shared_random_r_small.dat  # IOR shared random r small
mpiexec -hostfile ~/hfile -genv LD_PRELOAD /mnt/hasanfs/darshan-3.4.7/darshan-runtime/install/lib/libdarshan.so -n 10 /mnt/hasanfs/bin/ior -a MPIIO -k -r -z -b 402653184 -t 128m -o /mnt/hasanfs/synth_from_features/ior_shared_random_r_large.dat  # IOR shared random r large
mpiexec -hostfile ~/hfile -genv LD_PRELOAD /mnt/hasanfs/darshan-3.4.7/darshan-runtime/install/lib/libdarshan.so -n 10 /mnt/hasanfs/bin/mdtest -F -C -T -r -n 100 -d /mnt/hasanfs/synth_from_features/mdtree  # metadata
mpiexec -hostfile ~/hfile -genv LD_PRELOAD /mnt/hasanfs/darshan-3.4.7/darshan-runtime/install/lib/libdarshan.so -n 10 /mnt/hasanfs/bin/mpi_synthio -o /mnt/hasanfs/synth_from_features/ior_shared_sequential_r_small.dat --layout shared -t 64k -B 463929344 --p-write 0.200000 --p-rand 0.000000 --p-unaligned-file 1.000000 --p-unaligned-mem 0.666667 --rw-switch-prob 0.000000 --p-seq-read 0.500000 --p-seq-write 1.000000 --p-consec-read 0.500000 --p-consec-write 0.000000  # HARNESS follows shared sequential small
mpiexec -hostfile ~/hfile -genv LD_PRELOAD /mnt/hasanfs/darshan-3.4.7/darshan-runtime/install/lib/libdarshan.so -n 10 /mnt/hasanfs/bin/mpi_synthio -o /mnt/hasanfs/synth_from_features/ior_shared_sequential_r_large.dat --layout shared -t 128m -B 671088640 --p-write 0.200000 --p-rand 0.000000 --p-unaligned-file 1.000000 --p-unaligned-mem 0.666667 --rw-switch-prob 0.000000 --p-seq-read 0.500000 --p-seq-write 1.000000 --p-consec-read 0.500000 --p-consec-write 0.000000  # HARNESS follows shared sequential large
mpiexec -hostfile ~/hfile -genv LD_PRELOAD /mnt/hasanfs/darshan-3.4.7/darshan-runtime/install/lib/libdarshan.so -n 10 /mnt/hasanfs/bin/mpi_synthio -o /mnt/hasanfs/synth_from_features/ior_shared_random_r_small.dat --layout shared -t 64k -B 463929344 --p-write 0.200000 --p-rand 1.000000 --p-unaligned-file 1.000000 --p-unaligned-mem 0.666667 --rw-switch-prob 0.000000 --p-seq-read 0.500000 --p-seq-write 1.000000 --p-consec-read 0.500000 --p-consec-write 0.000000  # HARNESS follows shared random small
mpiexec -hostfile ~/hfile -genv LD_PRELOAD /mnt/hasanfs/darshan-3.4.7/darshan-runtime/install/lib/libdarshan.so -n 10 /mnt/hasanfs/bin/mpi_synthio -o /mnt/hasanfs/synth_from_features/ior_shared_random_r_large.dat --layout shared -t 128m -B 671088640 --p-write 0.200000 --p-rand 1.000000 --p-unaligned-file 1.000000 --p-unaligned-mem 0.666667 --rw-switch-prob 0.000000 --p-seq-read 0.500000 --p-seq-write 1.000000 --p-consec-read 0.500000 --p-consec-write 0.000000  # HARNESS follows shared random large
